(()=>{"use strict";class e{constructor(e,t,s){this._template=t,this._title=e.name,this._link=e.link,this._openImagePopup=s,this._element=this._template.cloneNode(!0)}_deleteCard(){this._element.remove()}_toggleLike(){this._element.querySelector(".element__like").classList.toggle("element__like_active")}_setEventListeners(){this._element.querySelector(".element__like").addEventListener("click",(()=>{this._toggleLike()})),this._element.querySelector(".element__delete").addEventListener("click",(()=>{this._deleteCard()})),this._element.querySelector(".element__image").addEventListener("click",this._openImagePopup)}generateCard(){return this._element.querySelector(".element__title").textContent=this._title,this._element.querySelector(".element__image").setAttribute("alt",this._title),this._element.querySelector(".element__image").setAttribute("src",this._link),this._setEventListeners(),this._element}}class t{constructor(e,t){this._config=e,this._formElement=t,this._inputs=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._button=this._formElement.querySelector(this._config.submitButtonSelector)}_checkInputValidity=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);e.validity.valid?(t.textContent="",t.classList.remove(this._config.errorClass),e.classList.remove(this._config.inputErrorClass)):(t.textContent=e.validationMessage,t.classList.add(this._config.errorClass),e.classList.add(this._config.inputErrorClass))};toggleButtonValid(){this._inputs.every((e=>e.validity.valid))?(this._button.classList.remove(this._config.inactiveButtonClass),this._button.disabled=""):(this._button.classList.add(this._config.inactiveButtonClass),this._button.disabled="disabled")}_setEventListeners(){this.toggleButtonValid(),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonValid()}))})),this._formElement.addEventListener("submit",(e=>{e.preventDefault()}))}enableValidation(){this._setEventListeners()}}class s{constructor(e){this._popup=e,this._closeBtn=this._popup.querySelector(".popup__closer"),this._escClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._escClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._escClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeBtn.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._popupForm=this._popup.querySelector(".popup__form"),this._inputs=this._popup.querySelectorAll(".popup__field"),this._handleFormSubmit=t}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{this._handleFormSubmit(e,this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}const o=document.querySelector(".profile__title"),i=document.querySelector(".profile__subtitle"),r=document.querySelector(".popup_type_edit"),l=document.querySelector(".popup_type_add"),p=document.querySelector(".popup_type_image"),c=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),u=document.querySelector('form[name="edit-form"]'),_=(u.querySelector("#nameInput"),u.querySelector("#jobInput"),document.querySelector(".card-template").content.querySelector(".element")),d=document.querySelector(".elements__list"),m=document.querySelector('form[name="add-form"]'),h={formSelector:".popup__form",inputSelector:".popup__field",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_invalid",inputErrorClass:"popup__field_type_error",errorClass:"popup__error_visible"};new t(h,u).enableValidation(),new t(h,m).enableValidation();const v=new class{constructor({name:e,job:t}){this._name=e,this._job=t}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}setUserInfo(e){nameInput.value=e.name,jobInput.value=e.job}}({name:o,job:i}),y=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__image"),this._popupDescription=this._popup.querySelector(".popup__description")}open(e,t){this._popupImage.src=t,this._popupImage.alt=e,this._popupDescription.textContent=e,super.open()}}(p);y.setEventListeners();const f=new n(l,((e,t)=>{e.preventDefault(),b({name:t.cardName,link:t.link}),f.close()}));f.setEventListeners();const g=new n(r,(function(e,t){e.preventDefault(),o.textContent=t.name,i.textContent=t.job,g.close()}));g.setEventListeners();const b=t=>{const s=new e(t,_,(()=>y.open(t.name,t.link))).generateCard();S.addItem(s)},S=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._containerSelector=s}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._containerSelector.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:b},d);S.renderItems(),a.addEventListener("click",(()=>f.open())),c.addEventListener("click",(()=>{const e=v.getUserInfo();v.setUserInfo(e),g.open()}))})();